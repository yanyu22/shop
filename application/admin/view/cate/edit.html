<!DOCTYPE html>
<html class="x-admin-sm">
    
    <head>
        <meta charset="UTF-8">
        <title>欢迎页面-X-admin2.2</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="__ADMIN__/css/font.css">
        <link rel="stylesheet" href="__ADMIN__/css/xadmin.css">
			<link rel="stylesheet" type="text/css" href="__ADMIN__/lib/webuploader/webuploader.css" />
		<script src="https://cdn.bootcdn.net/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script type="text/javascript" src="__ADMIN__/lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="__ADMIN__/js/xadmin.js"></script>
		<script type="text/javascript" src="__ADMIN__/lib/ueditor/1.4.3/ueditor.config.js"></script> 
		<script type="text/javascript" src="__ADMIN__/lib/ueditor/1.4.3/ueditor.all.min.js"> </script>
		<script type="text/javascript" src="__ADMIN__/lib/webuploader/webuploader.js"></script> 
   </head>
    
    <body>
	
     
    <div class="layui-fluid">
		
            <div class="layui-row">
			
                <form class="layui-form">
			
			<input type="hidden" name="id" value="{$data.cid}">	
			
			
	<div class="layui-tab">
  <ul class="layui-tab-title">
  <li class="layui-this">基本设置</li>
   <li>SEO设置</li>
    <li>内容设置</li>

  </ul>
  <div class="layui-tab-content">
  
  
  
  
  
  
  
    <div class="layui-tab-item layui-show">
	  <!--基本设置-->
	

				
				
			<div class="layui-form-item">
					<label class="layui-form-label">上级导航：</label>
					<div class="layui-input-inline">
					  <select name="pid" lay-verify="required">
					  
					  
					  {if $data.pid==0}
						<option value="0">顶级导航</option>
						{else/}
			
						{volist name="dataa"  id="vo"}
						<option value="{$vo.cid}"   {$vo.cid==$data.pid?'selected':''}>{$vo.level|str_repeat='------',###}{$vo.name}</option>
					{/volist}
						{/if}
					  </select>
					</div>
				  </div>
				
				
                    <div class="layui-form-item">
                        <label for="username" class="layui-form-label">
                            <span class="x-red">*</span>栏目名：</label>
                        <div class="layui-input-inline">
                            <input type="text" id="name" name="name" lay-verify="name"  value="{$data.name}" autocomplete="off" class="layui-input"></div>
                    </div>


									

     <hr>	

       <div class="layui-form-item">
                        <label for="username" class="layui-form-label">
                            <span class="x-red">*</span>排序：</label>
                        <div class="layui-input-inline">
                            <input type="text"  name="sort" lay-verify="required"  value="{$data.sort}"   autocomplete="off" class="layui-input"></div>
                    </div>
  
  
  
  
  		
  

				  <div class="layui-form-item">
					<label class="layui-form-label">模板：</label>
					<div class="layui-input-block">

					  <input  {if condition="$data.type eq 1"} checked {/if} type="radio" name="type" value="1" title="单页">
					  <input  {if condition="$data.type eq 2"} checked {/if} type="radio" name="type" value="2" title="文章" >
					  <input  {if condition="$data.type eq 3"} checked {/if} type="radio" name="type" value="3" title="商品" >
		              <input  {if condition="$data.type eq 4"} checked {/if} type="radio" name="type" value="4" title="案例" >
					  <input  {if condition="$data.type eq 5"} checked {/if} type="radio" name="type" value="5" title="联系我们" >
					  <input  {if condition="$data.type eq 6"} checked {/if} type="radio" name="type" value="6" title="荣誉资质" >
					</div>
				  </div>

		  <div class="layui-form-item">
					<label class="layui-form-label">是否/前台：</label>
					<div class="layui-input-block">
					  <input type="radio"  {if condition="$data.static eq 1"} checked {/if}   name="static" value="1" title="显示" >
					  <input type="radio"  {if condition="$data.static eq 0"} checked {/if}     name="static" value="0" title="隐藏" >
					</div>
		 </div>
		 
		 			<div class="layui-form-item">
                        <label for="username" class="layui-form-label">
						
                            <span class="x-red">*</span>缩略图</label>
							<div class="layui-input-block">
							
											<div id="uploader-demo">
															<!--用来存放item-->
																	<div id="fileList" class="uploader-list"></div>
																	<div id="filePicker">选择图片</div><span  style="color:red">(1920*450像素)</span>

																<div class="formControls col-xs-offset-4"   id="imgss"  style="margin-left:100px;width:270px;height:160px;border: 1px dashed #000">
																<img src="/{$data.pic}"    style="width:270px;height:160px;">
																</div>

													</div>		 

							</div>
                    </div>
				
		 			
			
		
  
	  <!--111111-->
	</div>
	<!--22222-->
	<div class="layui-tab-item">
	
	
	
	
	
  		
				  <div class="layui-form-item">
                        <label for="username" class="layui-form-label">
                            <span class="x-red">*</span>SEO标题：</label>
                        <div class="layui-input-block">
                            <input type="text" id="seotitle" name="seotitle"  autocomplete="off"     value="{$data.seotitle}"    class="layui-input"></div>
                    </div>
  
  
                      <div class="layui-form-item">
										<label for="username" class="layui-form-label">
											<span class="x-red">*</span>页面关键词：</label>
										<div class="layui-input-block">
											<input type="text" id="key" name="key" lay-verify="name"   value="{$data.key}"    autocomplete="off" class="layui-input"></div>
                     </div>
					
					
					  <div class="layui-form-item layui-form-text">
							<label class="layui-form-label">页面描述：</label>
							<div class="layui-input-block">
							  <textarea name="desc" placeholder="请输入内容" class="layui-textarea">{$data.desc}</textarea>
							</div>
					</div>
  
  
	
	
	
	</div>
	<!--222222-->
	<!--333333-->
    <div class="layui-tab-item">
	
		<div class="layui-form-item layui-form-text">
						<label class="layui-form-label">内容:</label>
						<div class="layui-input-block">
						<script id="container" type="text/plain"  name="content" style="width:100%;height:400px;">{$data.content}</script> 
						</div>
						
				 </div>
	
	
	
		 <div class="layui-form-item">
													<label for="username" class="layui-form-label">
														<span class="x-red"></span></label>
													<div class="layui-input-block">
												</div>
										</div>
									
	</div>
	<!--33333333-->
	


	


  </div>
</div>
 			

        <div class="layui-form-item">
            <label for="L_repass" class="layui-form-label"></label>
            <button class="layui-btn" lay-filter="update" lay-submit="">修改</button></div>
        </form>
        </div>
        <script>
		
		layui.use(['form', 'layer'],
            function() {
                $ = layui.jquery;
                var form = layui.form,
                layer = layui.layer;

                //自定义验证规则
                form.verify({
                    name: function(value) {
                        if (value.length < 2) {
                            return '名称至少得2个字符啊';
                        }
                    },
             
                });

                //监听提交
          form.on('submit(update)', function(data){
            //发异步，把数据提交给php
              $.post("{:url('/admin/cate/update')}",data.field,function(res){
                if(res.status=='success'){
                    layer.alert(res.msg, {icon: 6},function () {
                        parent.location.reload();
                        // 获得frame索引
                        var index = parent.layer.getFrameIndex(window.name);
                        //关闭当前frame
                        parent.layer.close(index);
                    });
                }else{
                    layer.msg(res.msg);
                }
              },'json');
            return false;
          });

            });</script>
                    <!-- 实例化编辑器 -->
             <!-- 实例化编辑器 -->
<script type="text/javascript">
        var ue = UE.getEditor('container');
 </script> 
 


  <script type="text/javascript">
       // 初始化Web Uploader
var uploader = WebUploader.create({

    // 选完文件后，是否自动上传。
    auto: true,
    
    compress:false,
    resize:false,
    // swf文件路径
    swf:'__ADMIN__/lib/webuploader/Uploader.swf',

    // 文件接收服务端。
    server: "{:url('/admin/cateImg')}",

    // 选择文件的按钮。可选。
    // 内部根据当前运行是创建，可能是input元素，也可能是flash.
    pick: '#filePicker',


    // 只允许选择图片文件。
    accept: {
        title: 'Images',
        extensions: 'gif,jpg,jpeg,bmp,png',
        mimeTypes: 'image/*',
        size:'1048576',
    }

});

// 文件上传成功，给item添加成功class, 用样式标记上传成功。
uploader.on( 'uploadSuccess', function(file,data ) {
    
if(data.status=='fail'){
   $('#imgss').html('<span style="color:red">'+data.info+'</span>');
}else{

$('#imgss').html('<img src=/'+data.info+'  style="width:260px;height:150px"  ><input type="hidden"  name="pic" value="'+data.info+'">');

}

});

</script>
    </body>

</html>